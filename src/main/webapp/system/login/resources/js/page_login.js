$(document).ready(function(){var utils=new Utils();var args=utils.getScriptArgs();$(".loading").hide();$(".login-error").hide();jQuery.focusblur=function(focusid){var focusblurid=$(focusid);var defval=focusblurid.val();focusblurid.focus(function(){var thisval=$(this).val();if(thisval==defval){$(this).val("")}});focusblurid.blur(function(){var thisval=$(this).val();if(thisval==""){$(this).val(defval)}})};$.focusblur("#email");$.focusblur("#password");var validate=$("#signupForm").validate({rules:{email:{required:true},password:{required:true,minlength:4,maxlength:16}},messages:{email:{required:$.i18n.prop("请输入用户名！"),email:$.i18n.prop("Form.PleaseInputCorrectEmail")},password:{required:$.i18n.prop("请输入密码！"),minlength:jQuery.format($.i18n.prop("密码长度少于4个字符，请重新输入！")),maxlength:jQuery.format($.i18n.prop("密码长度大于16个字符，请重新输入！"))}}});if($("#email").val()){$("#email").prev().fadeOut()}if($("#password").val()){$("#password").prev().fadeOut()}$("#email").focus(function(){$(this).prev().fadeOut()});$("#email").blur(function(){if(!$("#email").val()){$(this).prev().fadeIn()}});$("#password").focus(function(){$(this).prev().fadeOut()});$("#password").blur(function(){if(!$("#password").val()){$(this).prev().fadeIn()}});$("#submit").bind("click",function(){login(validate)})});function login(validate){var openId=$("#openId").val();var url=$("#url").val();if(validate.form()){$.ajax({url:"/zjyw/sys/SysWxyh/save",type:"post",data:{username:$("#email").val(),password:$("#password").val(),openId:openId},dataType:"json",beforeSend:function(){$(".loading").show()},success:function(data){$(".loading").hide();if(data=="1"){location.href=homePath+url+"?openId="+openId}else{if(data=="0"){alert("用户名或密码不正确，请重新输入！")}else{if(data=="2"){alert("该微信号已绑定过账户！")}else{if(data=="3"){alert("该微信号已绑定过账户！且已经被停用，请联系管理员。")}else{if(data=="4"){alert("该校园账户未授权，请联系管理员授权后在进行绑定微信号。")}}}}}}})}}var Utils=function(){};Utils.prototype.getScriptArgs=function(){var scripts=document.getElementsByTagName("script"),script=scripts[scripts.length-1],src=script.src,reg=/(?:\?|&)(.*?)=(.*?)(?=&|$)/g,temp,res={};while((temp=reg.exec(src))!=null){res[temp[1]]=decodeURIComponent(temp[2])}return res};